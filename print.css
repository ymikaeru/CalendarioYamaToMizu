/* --- IMPRESSÃO RIGOROSA (V3 SAFE ZONE) --- */

/* RESET TOTAL (Apenas para impressora real) */
@media print {
    @page {
        size: A4 portrait;
        margin: 0;
    }

    html,
    body {
        width: 210mm !important;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: visible !important;
        background: white !important;
    }
}

/* --- LÓGICA DE VISIBILIDADE --- */

/* Padrão (Mês Atual): Esconde tudo menos #calendario e .container (para o site normal funcionar) */
body:not(.printing-year)>*:not(#calendario):not(#grid-view):not(.container) {
    display: none !important;
}

/* Modo Ano Completo (Print Real): Esconde tudo menos #print-container */
body.printing-year>*:not(#print-container) {
    display: none !important;
}

body.printing-year #print-container {
    display: block !important;
}

body.printing-year #calendario {
    display: none !important;
}

/* --- LAYOUT DE IMPRESSÃO (Disponível para Print e Grid View via classe .print-mode) --- */

.print-mode {
    position: relative;
    width: 210mm;
    height: 297mm;
    background: white;
    overflow: hidden;
}

/* Estilos Base do Container de Impressão (Mês Atual) quando em modo print */
#calendario.print-mode {
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    box-shadow: none !important;
}

/* PÁGINA PARA O ANO COMPLETO */
#print-container {
    margin: 0;
    padding: 0;
    width: 210mm;
}

#print-container .pagina {
    position: relative !important;
    width: 210mm !important;
    height: 297mm !important;
    page-break-after: always !important;
    overflow: hidden !important;
    margin: 0 !important;
    padding: 0 !important;
}

/* --- LAYOUT ABSOLUTO RÍGIDO V3 (SAFE ZONE) --- */
/* Aplicado apenas dentro de elementos com classe .print-mode */

/* 1. SEÇÃO CALENDÁRIO (Esquerda) */
.print-mode .calendar-section {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 55% !important;
    height: 230mm !important;
    /* Segurança máxima */
    padding: 15mm 10mm 0 15mm !important;
    /* Top padding levemente menor */
    margin: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    background: transparent !important;
    /* Remove fundo branco do style.css */
}

/* 2. HEADER DA LISTA */
.print-mode .calendar-header {
    flex: 0 0 auto !important;
    margin-bottom: 1mm !important;
}

.print-mode .list-header {
    flex: 0 0 auto !important;
    display: flex !important;
    justify-content: space-between !important;
    /* border-bottom removido pelo usuário */
    margin-bottom: 1mm !important;
    padding-bottom: 1mm !important;
}

/* 3. LISTA DE DIAS (Flex-Fit) */
.print-mode .calendar-list {
    flex: 1 1 auto !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: space-between !important;
    height: 100% !important;
    overflow: hidden !important;
}

/* Dias auto-ajustáveis */
.print-mode .day-row {
    flex: 1 1 auto !important;
    display: grid !important;
    grid-template-columns: 35px 50px 1fr !important;
    align-items: center !important;
    padding: 0 !important;
    border-bottom: 0.5px dotted #ccc !important;
    min-height: 0 !important;
}

.print-mode .day-num {
    font-size: 10px !important;
    margin: 0 !important;
}

.print-mode .day-weekday-jp {
    font-size: 9px !important;
}

.print-mode .weekday-jp {
    position: relative;
    left: -96px
}


.print-mode .day-feriado {
    font-size: 8px !important;
    line-height: 1 !important;
    transform: scale(0.9);
    transform-origin: right center;
}


/* 4. SEÇÃO POESIA (Direita) - Vertical Layout Only */
.print-mode .hero-section {
    position: absolute !important;
    top: 19px !important;
    right: 0 !important;
    width: 45% !important;
    height: 230mm !important;
    padding: 20mm 0mm 0 0mm !important;
    background: transparent !important;
    border: none !important;
}

.print-mode .hero-section .poesia-columns {
    top: -30px !important;
    position: relative !important;
}

.print-mode .hero-section .poem-line {
    font-size: 30px !important;
    position: absolute !important;
    writing-mode: vertical-rl;
}

.print-mode .hero-section .poem-line:nth-child(1) {
    top: 15% !important;
    right: -10% !important;
}

.print-mode .hero-section .poem-line:nth-child(2) {
    top: 26% !important;
    right: 62% !important;
}

.print-mode .hero-section .poem-line:nth-child(3) {
    top: 46% !important;
    right: 100% !important;
}


/* 5. RODAPÉ (Baixo) */
.print-mode .calendar-footer {
    position: absolute !important;
    bottom: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 53mm !important;
    padding: 0 15mm 10mm 15mm !important;
    background: transparent !important;
    display: flex !important;
    align-items: flex-end !important;
    justify-content: space-between !important;
}

.print-mode .month-title {
    font-size: 22px !important;
    margin: 0 !important;
}

/* Centraliza a coluna do meio e faz ocupar toda a altura */
.print-mode .footer-traducao {
    position: relative !important;
    bottom: 0 !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: flex-start !important;
    padding-top: 5px !important;
    /* Ajuste para alinhar com o topo dos calendários */
}

.print-mode .source-header {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    padding-top: 10mm !important;
    /* Margem segura do topo */
    text-align: center !important;
    font-family: 'Cinzel', serif !important;
    font-size: 16px !important;
    /* Tamanho adequado para impressão */
    letter-spacing: 0.15em !important;
    color: #666 !important;
    text-transform: uppercase !important;
    writing-mode: horizontal-tb !important;
    margin: 0 !important;
    background: transparent !important;
}

.print-mode .source-header.sub {
    color: #a7a7a7 !important;
    top: 25px !important;
}

.print-mode .footer-obra-titulo {
    margin-bottom: 5px !important;
    position: static !important;
    /* Remove posicionamento relativo anterior */
    transform: none !important;
    width: auto !important;
    left: auto !important;
    top: auto !important;
    text-align: center !important;
    font-size: 14px !important;
    /* Ajuste se necessário */
    font-weight: bold !important;
    margin-top: 12px !important;
    /* Restaurado margem do topo */
}

.print-mode .romaji-texto {
    font-size: 10px !important;
    margin-bottom: auto !important;
    /* EMPURRA A TRADUÇÃO PARA BAIXO */
    text-align: center !important;
}

.print-mode .traducao-texto {
    font-size: 1.1rem !important;
    line-height: 1.3 !important;
    text-align: center !important;
}

/* Alinhamento superior dos mini calendarios */
.print-mode .footer-mini-cal {
    align-self: flex-start !important;
    margin-top: 10px !important;
    /* Pequeno ajuste para não colar no topo absoluto */
}

/* --- PRINT RULES FOR NORDIC LAYOUT (19x15cm) --- */

@page nordic {
    size: 190mm 150mm;
    margin: 0;
}

body:has(.layout-nordic) {
    /* Alguns navegadores suportam isso para mudar o tamanho da página dinamicamente */
    /* size: 190mm 150mm; */
}

@media print {

    /* Associa a classe ao nome da página definido acima (suporte Chrome/Edge) */
    .layout-nordic {
        page: nordic;
        width: 190mm !important;
        height: 150mm !important;
        page-break-inside: avoid;
        margin: 0 !important;
        /* Padding igual ao style.css */
        padding-top: 40px !important;

        box-shadow: none !important;
        border: none !important;

        /* Garante posicionamento correto para impressão */
        position: relative !important;
        left: 0 !important;
        top: 0 !important;
    }

    /* REPLICANDO ESTILOS DO STYLE.CSS PARA GARANTIR PRECISÃO NO PRINT */

    .nordic-month {
        font-size: 28px !important;
    }

    .nordic-right-panel {
        width: 70% !important;
    }

    /* Se a direita aumentou para 70%, a esquerda deve diminuir se for flex, 
       mas style.css mostra esquerda com 50% fixo?
       Se o container é flex row, e esquerda é width 50% e direita 70%, vai estourar.
       O usuário mudou APENAS a direita para 70%.
       Vou assumir que a esquerda deve ser 30% ou auto. 
       Na dúvida, vou forçar esquerda para 30% para caber, já que o usuário não mandou diff da esquerda.
       Ou deixo o usuário corrigir se quebrar.
       Melhor seguir o fluxo: Direita 70%.
    */

    .nordic-left-panel {
        width: 30% !important;
    }

    .nordic-left-panel .poem-line {
        font-size: 20px !important;
        color: #555 !important;
    }

    .nordic-left-panel .poem-line:nth-child(1) {
        right: 35% !important;
        top: 5% !important;
    }

    .nordic-left-panel .poem-line:nth-child(2) {
        top: 5% !important;
        /* right mantido do style.css ou herdado */
    }

    .nordic-left-panel .poem-line:nth-child(3) {
        left: 42% !important;
        top: 5% !important;
    }

    /* Quebra de linha nos feriados */
    .nordic-holiday-name {
        white-space: normal !important;
        word-wrap: break-word !important;
        line-height: 1.1 !important;
    }

    /* Regra de fallback caso o browser não suporte custom page names */
    body.print-nordic {
        width: 190mm;
        height: 150mm;
    }
}